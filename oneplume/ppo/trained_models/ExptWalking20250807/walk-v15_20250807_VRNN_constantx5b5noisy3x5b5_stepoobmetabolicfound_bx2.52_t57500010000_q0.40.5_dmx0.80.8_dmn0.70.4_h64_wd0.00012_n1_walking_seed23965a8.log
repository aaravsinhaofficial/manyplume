CUDA: False
Namespace(algo='ppo', lr=0.0003, eps=1e-05, alpha=0.99, gamma=0.99, use_gae=True, gae_lambda=0.95, entropy_coef=0.005, value_loss_coef=0.5, max_grad_norm=0.5, seed=23965, cuda_deterministic=False, num_processes=1, num_steps=2048, ppo_epoch=10, num_mini_batch=1, clip_param=0.2, log_interval=1, save_interval=100, no_cuda=False, use_proper_time_limits=False, recurrent_policy=True, use_linear_lr_decay=True, env_name='plume', log_dir='/tmp/gym/', save_dir='./trained_models/ExptWalking20250807/', dynamic=False, eval_type='fixed', eval_episodes=20, eval_interval=None, weight_decay=0.00012, rnn_type='VRNN', hidden_size=64, betadist=False, stacking=0, masking=None, stride=1, dataset=['constantx5b5', 'noisy3x5b5'], num_env_steps=[575000, 10000], qvar=[0.4, 0.5], birthx=[2.5, 2.0], diff_max=[0.8, 0.8], diff_min=[0.7, 0.4], birthx_max=1.0, dryrun=False, curriculum=False, turnx=1.0, movex=1.0, auto_movex=False, auto_reward=False, loc_algo='uniform', time_algo='uniform', env_dt=0.04, outsuffix='walk-v15_20250807_VRNN_constantx5b5noisy3x5b5_stepoobmetabolicfound_bx2.52_t57500010000_q0.40.5_dmx0.80.8_dmn0.70.4_h64_wd0.00012_n1_walking_seed23965a8', walking=True, radiusx=1.0, diffusion_min=1.0, diffusion_max=1.0, r_shaping=['step', 'oob', 'metabolic', 'found'], wind_rel=True, action_feedback=False, squash_action=True, flipping=True, odor_scaling=True, stray_max=2.0, test_episodes=50, viz_episodes=10, model_fname='', obs_noise=0.0, act_noise=0.0, cuda=False)
PPO Args ---> Namespace(algo='ppo', lr=0.0003, eps=1e-05, alpha=0.99, gamma=0.99, use_gae=True, gae_lambda=0.95, entropy_coef=0.005, value_loss_coef=0.5, max_grad_norm=0.5, seed=23965, cuda_deterministic=False, num_processes=1, num_steps=2048, ppo_epoch=10, num_mini_batch=1, clip_param=0.2, log_interval=1, save_interval=100, no_cuda=False, use_proper_time_limits=False, recurrent_policy=True, use_linear_lr_decay=True, env_name='plume', log_dir='/tmp/gym/', save_dir='./trained_models/ExptWalking20250807/', dynamic=False, eval_type='fixed', eval_episodes=20, eval_interval=None, weight_decay=0.00012, rnn_type='VRNN', hidden_size=64, betadist=False, stacking=0, masking=None, stride=1, dataset=['constantx5b5', 'noisy3x5b5'], num_env_steps=[575000, 10000], qvar=[0.4, 0.5], birthx=[2.5, 2.0], diff_max=[0.8, 0.8], diff_min=[0.7, 0.4], birthx_max=1.0, dryrun=False, curriculum=False, turnx=1.0, movex=1.0, auto_movex=False, auto_reward=False, loc_algo='uniform', time_algo='uniform', env_dt=0.04, outsuffix='walk-v15_20250807_VRNN_constantx5b5noisy3x5b5_stepoobmetabolicfound_bx2.52_t57500010000_q0.40.5_dmx0.80.8_dmn0.70.4_h64_wd0.00012_n1_walking_seed23965a8', walking=True, radiusx=1.0, diffusion_min=1.0, diffusion_max=1.0, r_shaping=['step', 'oob', 'metabolic', 'found'], wind_rel=True, action_feedback=False, squash_action=True, flipping=True, odor_scaling=True, stray_max=2.0, test_episodes=50, viz_episodes=10, model_fname='', obs_noise=0.0, act_noise=0.0, cuda=False)
Using Precomputed Plume...
PlumeEnvironment: {'self': <plume_env.PlumeEnvironment object at 0x3016e6250>, 't_val_min': 10.0, 'sim_steps_max': 2200, 'reset_offset_tmax': 30, 'dataset': 'constantx5b5', 'move_capacity': 2.0, 'turn_capacity': 19.634954084936208, 'wind_obsx': 1.0, 'movex': 1.0, 'turnx': 1.0, 'birthx': 2.5, 'birthx_max': 1.0, 'env_dt': 0.04, 'loc_algo': 'uniform', 'qvar': 0.4, 'time_algo': 'uniform', 'angle_algo': 'uniform', 'homed_radius': 0.2, 'stray_max': 2.0, 'wind_rel': True, 'auto_movex': False, 'auto_reward': False, 'diff_max': 0.8, 'diff_min': 0.7, 'r_shaping': ['step', 'oob', 'metabolic', 'found'], 'rewardx': 1.0, 'rescale': False, 'squash_action': True, 'walking': True, 'walk_move': 0.05, 'walk_turn': 3.14159, 'radiusx': 1.0, 'diffusion_min': 1.0, 'diffusion_max': 1.0, 'action_feedback': False, 'flipping': True, 'odor_scaling': True, 'obs_noise': 0.0, 'act_noise': 0.0, 'dynamic': False, 'seed': 23965, 'verbose': 0, '__class__': <class 'plume_env.PlumeEnvironment'>}
Squashing actions to 0-1
constantx5b5
wind: t_val_diff 0.03999999999999915 env_dt 0.04
puffs: t_val_diff 0.03999999999999915 env_dt 0.04
Reward Shaping ['step', 'oob', 'metabolic', 'found']
Using Precomputed Plume...
PlumeEnvironment: {'self': <plume_env.PlumeEnvironment object at 0x3016d8520>, 't_val_min': 10.0, 'sim_steps_max': 2200, 'reset_offset_tmax': 30, 'dataset': 'constantx5b5', 'move_capacity': 2.0, 'turn_capacity': 19.634954084936208, 'wind_obsx': 1.0, 'movex': 1.0, 'turnx': 1.0, 'birthx': 2.5, 'birthx_max': 1.0, 'env_dt': 0.04, 'loc_algo': 'uniform', 'qvar': 0.4, 'time_algo': 'uniform', 'angle_algo': 'uniform', 'homed_radius': 0.2, 'stray_max': 2.0, 'wind_rel': True, 'auto_movex': False, 'auto_reward': False, 'diff_max': 0.8, 'diff_min': 0.7, 'r_shaping': ['step', 'oob', 'metabolic', 'found'], 'rewardx': 1.0, 'rescale': False, 'squash_action': True, 'walking': True, 'walk_move': 0.05, 'walk_turn': 3.14159, 'radiusx': 1.0, 'diffusion_min': 1.0, 'diffusion_max': 1.0, 'action_feedback': False, 'flipping': True, 'odor_scaling': True, 'obs_noise': 0.0, 'act_noise': 0.0, 'dynamic': False, 'seed': 23965, 'verbose': 0, '__class__': <class 'plume_env.PlumeEnvironment'>}
Squashing actions to 0-1
constantx5b5
wind: t_val_diff 0.03999999999999915 env_dt 0.04
puffs: t_val_diff 0.03999999999999915 env_dt 0.04
Reward Shaping ['step', 'oob', 'metabolic', 'found']
Using MLPBase
hidden_size 64
Using VanillaRNN
Saved ./trained_models/ExptWalking20250807//plume_walk-v15_20250807_VRNN_constantx5b5noisy3x5b5_stepoobmetabolicfound_bx2.52_t57500010000_q0.40.5_dmx0.80.8_dmn0.70.4_h64_wd0.00012_n1_walking_seed23965a8.pt.start
Stage: 0/2 - constantx5b5 b2.5 q0.4 n575000
Saved ./trained_models/ExptWalking20250807/plume_walk-v15_20250807_VRNN_constantx5b5noisy3x5b5_stepoobmetabolicfound_bx2.52_t57500010000_q0.40.5_dmx0.80.8_dmn0.70.4_h64_wd0.00012_n1_walking_seed23965a8.pt
Update 0/280, T 2048, FPS 122, 22-training-episode: mean/median -1.1/-1.7, min/max -3.0/8.9
Update 1/280, T 4096, FPS 115, 48-training-episode: mean/median 3.5/-1.3, min/max -3.0/101.5
Update 2/280, T 6144, FPS 114, 50-training-episode: mean/median 3.4/-1.1, min/max -3.0/101.5
Update 3/280, T 8192, FPS 114, 50-training-episode: mean/median 1.2/-1.1, min/max -3.0/100.7
Update 4/280, T 10240, FPS 114, 50-training-episode: mean/median 5.5/-1.1, min/max -2.4/101.6
Update 5/280, T 12288, FPS 113, 50-training-episode: mean/median 7.4/-1.3, min/max -2.2/101.9
Update 6/280, T 14336, FPS 115, 50-training-episode: mean/median 3.4/-1.1, min/max -2.0/110.9
Update 7/280, T 16384, FPS 118, 50-training-episode: mean/median 4.0/-0.9, min/max -2.1/111.2
Update 8/280, T 18432, FPS 120, 50-training-episode: mean/median 5.7/-1.0, min/max -2.1/111.2
Update 9/280, T 20480, FPS 122, 50-training-episode: mean/median 7.4/-1.1, min/max -2.3/111.1
Update 10/280, T 22528, FPS 124, 50-training-episode: mean/median 7.8/-1.2, min/max -2.4/111.1
Update 11/280, T 24576, FPS 125, 50-training-episode: mean/median 9.5/-1.1, min/max -2.4/111.1
Update 12/280, T 26624, FPS 126, 50-training-episode: mean/median 9.6/-1.0, min/max -2.2/101.7
Update 13/280, T 28672, FPS 127, 50-training-episode: mean/median 11.6/-0.9, min/max -2.2/101.7
Update 14/280, T 30720, FPS 127, 50-training-episode: mean/median 7.5/-1.0, min/max -2.2/101.7
Update 15/280, T 32768, FPS 128, 50-training-episode: mean/median 11.6/-1.1, min/max -2.1/102.2
Update 16/280, T 34816, FPS 129, 50-training-episode: mean/median 13.5/-0.9, min/max -2.1/111.0
Update 17/280, T 36864, FPS 129, 50-training-episode: mean/median 17.7/-0.8, min/max -2.1/111.0
Update 18/280, T 38912, FPS 130, 50-training-episode: mean/median 11.6/-0.8, min/max -1.8/111.6
Update 19/280, T 40960, FPS 130, 50-training-episode: mean/median 15.7/-0.7, min/max -2.4/111.6
Update 20/280, T 43008, FPS 131, 50-training-episode: mean/median 21.6/-0.7, min/max -2.4/102.3
Update 21/280, T 45056, FPS 131, 50-training-episode: mean/median 25.8/-0.7, min/max -2.4/102.3
Update 22/280, T 47104, FPS 132, 50-training-episode: mean/median 28.3/-0.6, min/max -1.8/111.1
Update 23/280, T 49152, FPS 132, 50-training-episode: mean/median 36.5/-0.2, min/max -1.6/111.1
Update 24/280, T 51200, FPS 132, 50-training-episode: mean/median 36.9/-0.3, min/max -1.8/111.6
Update 25/280, T 53248, FPS 133, 50-training-episode: mean/median 30.3/-0.9, min/max -2.6/111.6
Update 26/280, T 55296, FPS 133, 50-training-episode: mean/median 32.4/-0.8, min/max -2.6/111.3
Update 27/280, T 57344, FPS 133, 50-training-episode: mean/median 28.4/-0.9, min/max -2.2/111.3
Update 28/280, T 59392, FPS 133, 50-training-episode: mean/median 37.0/-0.4, min/max -2.2/111.2
Update 29/280, T 61440, FPS 134, 50-training-episode: mean/median 36.6/-0.6, min/max -1.8/111.2
Update 30/280, T 63488, FPS 134, 50-training-episode: mean/median 28.1/-0.7, min/max -1.8/111.2
Update 31/280, T 65536, FPS 134, 50-training-episode: mean/median 32.3/-0.6, min/max -1.7/111.0
Update 32/280, T 67584, FPS 134, 50-training-episode: mean/median 30.4/-0.7, min/max -1.7/110.7
Update 33/280, T 69632, FPS 134, 50-training-episode: mean/median 24.5/-0.7, min/max -2.0/111.3
Update 34/280, T 71680, FPS 134, 50-training-episode: mean/median 28.7/-0.4, min/max -2.0/111.4
Update 35/280, T 73728, FPS 135, 50-training-episode: mean/median 24.2/-0.4, min/max -2.0/111.4
Update 36/280, T 75776, FPS 135, 50-training-episode: mean/median 22.3/-0.4, min/max -1.9/111.6
Update 37/280, T 77824, FPS 135, 50-training-episode: mean/median 22.0/-0.6, min/max -1.7/111.6
Update 38/280, T 79872, FPS 135, 50-training-episode: mean/median 21.7/-0.7, min/max -1.7/102.2
Update 39/280, T 81920, FPS 135, 50-training-episode: mean/median 24.2/-0.7, min/max -1.7/111.3
Update 40/280, T 83968, FPS 135, 50-training-episode: mean/median 32.6/-0.2, min/max -2.2/111.3
Update 41/280, T 86016, FPS 135, 50-training-episode: mean/median 41.2/-0.0, min/max -2.2/111.6
Update 42/280, T 88064, FPS 135, 50-training-episode: mean/median 41.4/0.1, min/max -2.2/111.6
Update 43/280, T 90112, FPS 136, 50-training-episode: mean/median 34.5/-0.3, min/max -1.9/111.0
Update 44/280, T 92160, FPS 136, 50-training-episode: mean/median 36.1/-0.3, min/max -1.8/102.3
Update 45/280, T 94208, FPS 136, 50-training-episode: mean/median 42.2/-0.2, min/max -1.8/102.4
Update 46/280, T 96256, FPS 136, 50-training-episode: mean/median 48.5/4.5, min/max -1.8/102.4
Update 47/280, T 98304, FPS 136, 50-training-episode: mean/median 38.6/-0.1, min/max -1.6/110.8
Update 48/280, T 100352, FPS 136, 50-training-episode: mean/median 34.4/-0.6, min/max -1.7/111.4
Update 49/280, T 102400, FPS 136, 50-training-episode: mean/median 36.9/-0.1, min/max -1.7/111.4
Update 50/280, T 104448, FPS 136, 50-training-episode: mean/median 34.7/0.1, min/max -1.6/111.4
Update 51/280, T 106496, FPS 136, 50-training-episode: mean/median 37.2/0.1, min/max -1.7/111.6
Update 52/280, T 108544, FPS 136, 50-training-episode: mean/median 36.8/-0.5, min/max -1.9/111.6
Update 53/280, T 110592, FPS 136, 50-training-episode: mean/median 40.9/-0.2, min/max -1.9/111.6
Update 54/280, T 112640, FPS 136, 50-training-episode: mean/median 54.9/101.1, min/max -1.9/111.1
Update 55/280, T 114688, FPS 136, 50-training-episode: mean/median 55.2/101.3, min/max -1.7/111.1
Update 56/280, T 116736, FPS 137, 50-training-episode: mean/median 51.1/55.3, min/max -1.7/111.4
Update 57/280, T 118784, FPS 137, 50-training-episode: mean/median 42.7/-0.0, min/max -1.8/111.4
Update 58/280, T 120832, FPS 137, 50-training-episode: mean/median 44.4/-0.1, min/max -1.8/102.3
Update 59/280, T 122880, FPS 137, 50-training-episode: mean/median 32.2/-0.7, min/max -1.6/102.3
Update 60/280, T 124928, FPS 137, 50-training-episode: mean/median 36.1/-0.5, min/max -1.6/102.3
Update 61/280, T 126976, FPS 137, 50-training-episode: mean/median 40.4/-0.2, min/max -1.5/102.3
Update 62/280, T 129024, FPS 137, 50-training-episode: mean/median 38.7/-0.1, min/max -1.5/102.3
Update 63/280, T 131072, FPS 137, 50-training-episode: mean/median 36.7/0.0, min/max -1.5/102.3
Update 64/280, T 133120, FPS 137, 50-training-episode: mean/median 32.4/-0.4, min/max -1.5/102.3
Update 65/280, T 135168, FPS 137, 50-training-episode: mean/median 28.0/-0.3, min/max -1.5/102.0
Update 66/280, T 137216, FPS 137, 50-training-episode: mean/median 32.3/-0.3, min/max -1.4/102.4
Update 67/280, T 139264, FPS 137, 50-training-episode: mean/median 42.9/-0.1, min/max -1.8/111.5
Update 68/280, T 141312, FPS 137, 50-training-episode: mean/median 51.2/55.1, min/max -1.8/111.5
Update 69/280, T 143360, FPS 137, 50-training-episode: mean/median 40.9/-0.3, min/max -1.8/111.5
Update 70/280, T 145408, FPS 137, 50-training-episode: mean/median 24.2/-0.8, min/max -1.8/102.3
Update 71/280, T 147456, FPS 137, 50-training-episode: mean/median 22.3/-0.7, min/max -1.8/111.4
Update 72/280, T 149504, FPS 138, 50-training-episode: mean/median 24.3/-0.7, min/max -1.7/111.4
Update 73/280, T 151552, FPS 138, 50-training-episode: mean/median 34.5/-0.7, min/max -1.8/111.4
Update 74/280, T 153600, FPS 138, 50-training-episode: mean/median 34.2/-0.5, min/max -1.8/102.1
Update 75/280, T 155648, FPS 138, 50-training-episode: mean/median 30.3/-0.4, min/max -1.8/102.1
Update 76/280, T 157696, FPS 138, 50-training-episode: mean/median 24.3/-0.5, min/max -1.8/111.7
Update 77/280, T 159744, FPS 138, 50-training-episode: mean/median 22.4/-0.8, min/max -1.7/111.7
Update 78/280, T 161792, FPS 138, 50-training-episode: mean/median 24.5/-0.8, min/max -1.7/111.7
Update 79/280, T 163840, FPS 138, 50-training-episode: mean/median 24.1/-0.8, min/max -1.7/111.4
Update 80/280, T 165888, FPS 138, 50-training-episode: mean/median 26.1/-0.8, min/max -2.4/111.4
Update 81/280, T 167936, FPS 138, 50-training-episode: mean/median 20.1/-0.8, min/max -2.4/111.0
Update 82/280, T 169984, FPS 139, 50-training-episode: mean/median 26.3/-0.7, min/max -2.4/111.0
Update 83/280, T 172032, FPS 139, 50-training-episode: mean/median 26.1/-0.8, min/max -2.4/102.4
Update 84/280, T 174080, FPS 139, 50-training-episode: mean/median 38.3/-0.7, min/max -1.5/102.4
Update 85/280, T 176128, FPS 139, 50-training-episode: mean/median 38.1/-0.7, min/max -1.6/102.4
Update 86/280, T 178176, FPS 139, 50-training-episode: mean/median 29.8/-0.8, min/max -1.8/102.3
Update 87/280, T 180224, FPS 139, 50-training-episode: mean/median 28.0/-0.9, min/max -3.4/110.2
Update 88/280, T 182272, FPS 139, 50-training-episode: mean/median 25.9/-0.9, min/max -3.4/110.2
Update 89/280, T 184320, FPS 139, 50-training-episode: mean/median 19.9/-1.0, min/max -3.4/110.2
Update 90/280, T 186368, FPS 139, 50-training-episode: mean/median 28.5/-0.9, min/max -3.4/111.2
Update 91/280, T 188416, FPS 139, 50-training-episode: mean/median 34.4/-0.9, min/max -2.6/111.2
Update 92/280, T 190464, FPS 140, 50-training-episode: mean/median 32.6/-0.8, min/max -2.9/111.2
Update 93/280, T 192512, FPS 140, 50-training-episode: mean/median 32.8/-0.5, min/max -2.9/111.2
Update 94/280, T 194560, FPS 140, 50-training-episode: mean/median 31.0/-0.5, min/max -2.9/111.4
Update 95/280, T 196608, FPS 140, 50-training-episode: mean/median 29.2/-0.6, min/max -2.9/111.4
Update 96/280, T 198656, FPS 140, 50-training-episode: mean/median 31.4/-0.5, min/max -2.3/111.4
Update 97/280, T 200704, FPS 140, 50-training-episode: mean/median 28.8/-0.7, min/max -2.3/111.4
Update 98/280, T 202752, FPS 141, 50-training-episode: mean/median 26.3/-0.7, min/max -2.3/110.8
Update 99/280, T 204800, FPS 141, 50-training-episode: mean/median 32.1/-0.8, min/max -1.7/110.8
Saved ./trained_models/ExptWalking20250807/plume_walk-v15_20250807_VRNN_constantx5b5noisy3x5b5_stepoobmetabolicfound_bx2.52_t57500010000_q0.40.5_dmx0.80.8_dmn0.70.4_h64_wd0.00012_n1_walking_seed23965a8.pt
Update 100/280, T 206848, FPS 141, 50-training-episode: mean/median 42.4/-0.5, min/max -1.7/110.8
Update 101/280, T 208896, FPS 141, 50-training-episode: mean/median 50.4/50.4, min/max -1.7/102.4
Update 102/280, T 210944, FPS 141, 50-training-episode: mean/median 44.5/-0.1, min/max -1.7/111.3
Update 103/280, T 212992, FPS 141, 50-training-episode: mean/median 38.2/-0.7, min/max -1.7/111.3
Update 104/280, T 215040, FPS 141, 50-training-episode: mean/median 34.3/-0.7, min/max -2.0/111.3
Update 105/280, T 217088, FPS 142, 50-training-episode: mean/median 38.3/-0.6, min/max -2.0/102.3
Update 106/280, T 219136, FPS 142, 50-training-episode: mean/median 38.3/-0.6, min/max -2.0/102.3
Update 107/280, T 221184, FPS 142, 50-training-episode: mean/median 30.1/-0.7, min/max -1.6/102.3
Update 108/280, T 223232, FPS 142, 50-training-episode: mean/median 24.1/-0.7, min/max -2.1/102.3
Update 109/280, T 225280, FPS 142, 50-training-episode: mean/median 18.3/-0.7, min/max -2.1/102.4
Update 110/280, T 227328, FPS 142, 50-training-episode: mean/median 22.4/-0.8, min/max -2.1/111.4
Update 111/280, T 229376, FPS 142, 50-training-episode: mean/median 30.5/-0.7, min/max -1.9/111.4
Update 112/280, T 231424, FPS 142, 50-training-episode: mean/median 34.4/-0.6, min/max -1.7/102.2
Update 113/280, T 233472, FPS 142, 50-training-episode: mean/median 40.6/-0.5, min/max -1.7/102.3
Update 114/280, T 235520, FPS 142, 50-training-episode: mean/median 36.4/-0.5, min/max -1.7/102.3
Update 115/280, T 237568, FPS 143, 50-training-episode: mean/median 32.3/-0.6, min/max -1.7/102.3
Update 116/280, T 239616, FPS 143, 50-training-episode: mean/median 34.4/-0.5, min/max -1.6/102.3
Update 117/280, T 241664, FPS 143, 50-training-episode: mean/median 38.8/-0.6, min/max -1.7/111.6
Update 118/280, T 243712, FPS 143, 50-training-episode: mean/median 37.0/-0.5, min/max -1.8/111.6
Update 119/280, T 245760, FPS 143, 50-training-episode: mean/median 28.1/-0.7, min/max -2.1/111.6
Update 120/280, T 247808, FPS 143, 50-training-episode: mean/median 32.3/-0.6, min/max -2.1/102.3
Update 121/280, T 249856, FPS 143, 50-training-episode: mean/median 38.7/-0.2, min/max -1.8/111.7
Update 122/280, T 251904, FPS 143, 50-training-episode: mean/median 44.9/0.3, min/max -1.8/111.7
Update 123/280, T 253952, FPS 143, 50-training-episode: mean/median 38.8/-0.1, min/max -1.7/111.7
Update 124/280, T 256000, FPS 144, 50-training-episode: mean/median 40.7/-0.3, min/max -1.7/111.8
Update 125/280, T 258048, FPS 144, 50-training-episode: mean/median 40.7/-0.2, min/max -1.7/111.8
Update 126/280, T 260096, FPS 144, 50-training-episode: mean/median 40.6/-0.1, min/max -1.7/111.8
Update 127/280, T 262144, FPS 144, 50-training-episode: mean/median 40.6/-0.2, min/max -1.7/111.4
Update 128/280, T 264192, FPS 144, 50-training-episode: mean/median 40.4/-0.4, min/max -1.7/102.2
Update 129/280, T 266240, FPS 144, 50-training-episode: mean/median 40.5/-0.5, min/max -1.7/111.2
Update 130/280, T 268288, FPS 144, 50-training-episode: mean/median 30.6/-0.7, min/max -1.7/111.2
Update 131/280, T 270336, FPS 144, 50-training-episode: mean/median 22.0/-0.6, min/max -1.7/102.2
Update 132/280, T 272384, FPS 144, 50-training-episode: mean/median 26.0/-0.6, min/max -1.7/102.2
Update 133/280, T 274432, FPS 144, 50-training-episode: mean/median 32.4/-0.6, min/max -1.6/102.3
Update 134/280, T 276480, FPS 144, 50-training-episode: mean/median 38.6/-0.1, min/max -1.6/111.1
Update 135/280, T 278528, FPS 144, 50-training-episode: mean/median 30.3/-0.6, min/max -1.6/111.1
Update 136/280, T 280576, FPS 144, 50-training-episode: mean/median 38.5/-0.3, min/max -1.5/111.0
Update 137/280, T 282624, FPS 144, 50-training-episode: mean/median 42.6/-0.3, min/max -1.7/111.4
Update 138/280, T 284672, FPS 144, 50-training-episode: mean/median 24.3/-0.7, min/max -1.7/111.4
Update 139/280, T 286720, FPS 144, 50-training-episode: mean/median 30.7/-0.7, min/max -1.6/111.8
Update 140/280, T 288768, FPS 144, 50-training-episode: mean/median 28.6/-0.0, min/max -1.7/111.8
Update 141/280, T 290816, FPS 145, 50-training-episode: mean/median 26.6/-0.0, min/max -1.7/111.8
Update 142/280, T 292864, FPS 145, 50-training-episode: mean/median 28.1/-0.5, min/max -1.7/102.3
Update 143/280, T 294912, FPS 145, 50-training-episode: mean/median 31.9/-0.6, min/max -1.7/102.3
Update 144/280, T 296960, FPS 145, 50-training-episode: mean/median 42.8/0.2, min/max -1.7/102.4
Update 145/280, T 299008, FPS 145, 50-training-episode: mean/median 45.3/8.9, min/max -1.7/111.2
Update 146/280, T 301056, FPS 145, 50-training-episode: mean/median 44.7/0.2, min/max -1.7/111.2
Update 147/280, T 303104, FPS 145, 50-training-episode: mean/median 42.4/0.1, min/max -1.7/102.3
Update 148/280, T 305152, FPS 145, 50-training-episode: mean/median 43.0/0.1, min/max -1.7/111.3
Update 149/280, T 307200, FPS 145, 50-training-episode: mean/median 47.1/4.6, min/max -1.8/110.8
Update 150/280, T 309248, FPS 145, 50-training-episode: mean/median 46.6/-0.5, min/max -1.8/111.2
Update 151/280, T 311296, FPS 145, 50-training-episode: mean/median 52.6/100.9, min/max -1.8/111.2
Update 152/280, T 313344, FPS 145, 50-training-episode: mean/median 67.7/101.5, min/max -1.8/111.2
Update 153/280, T 315392, FPS 145, 50-training-episode: mean/median 59.4/101.5, min/max -1.7/111.0
Update 154/280, T 317440, FPS 145, 50-training-episode: mean/median 54.9/101.5, min/max -1.7/102.2
Update 155/280, T 319488, FPS 145, 50-training-episode: mean/median 38.7/-0.4, min/max -1.8/110.9
Update 156/280, T 321536, FPS 145, 50-training-episode: mean/median 34.5/-0.6, min/max -1.8/110.9
Update 157/280, T 323584, FPS 145, 50-training-episode: mean/median 26.5/-0.6, min/max -1.8/110.9
Update 158/280, T 325632, FPS 145, 50-training-episode: mean/median 36.7/-0.5, min/max -1.7/111.4
Update 159/280, T 327680, FPS 145, 50-training-episode: mean/median 34.9/-0.5, min/max -1.7/111.4
Update 160/280, T 329728, FPS 145, 50-training-episode: mean/median 30.6/-0.5, min/max -1.5/102.4
Update 161/280, T 331776, FPS 146, 50-training-episode: mean/median 36.9/-0.3, min/max -1.5/102.4
Update 162/280, T 333824, FPS 146, 50-training-episode: mean/median 28.7/-0.4, min/max -1.5/102.4
Update 163/280, T 335872, FPS 146, 50-training-episode: mean/median 36.4/-0.6, min/max -1.5/102.3
Update 164/280, T 337920, FPS 146, 50-training-episode: mean/median 34.4/-0.6, min/max -1.5/102.3
Update 165/280, T 339968, FPS 146, 50-training-episode: mean/median 30.6/-0.6, min/max -1.5/102.3
Update 166/280, T 342016, FPS 146, 50-training-episode: mean/median 16.4/-0.6, min/max -1.7/102.3
Update 167/280, T 344064, FPS 146, 50-training-episode: mean/median 12.2/-0.7, min/max -1.7/102.3
Update 168/280, T 346112, FPS 146, 50-training-episode: mean/median 16.2/-0.6, min/max -1.7/102.2
Update 169/280, T 348160, FPS 146, 50-training-episode: mean/median 24.6/-0.4, min/max -1.7/102.3
Update 170/280, T 350208, FPS 146, 50-training-episode: mean/median 28.7/-0.5, min/max -1.7/111.3
Update 171/280, T 352256, FPS 146, 50-training-episode: mean/median 31.0/-0.2, min/max -1.6/111.3
Update 172/280, T 354304, FPS 146, 50-training-episode: mean/median 32.5/-0.2, min/max -1.6/111.3
Update 173/280, T 356352, FPS 146, 50-training-episode: mean/median 34.4/-0.1, min/max -1.7/102.3
Update 174/280, T 358400, FPS 146, 50-training-episode: mean/median 34.1/-0.2, min/max -1.7/102.3
Update 175/280, T 360448, FPS 146, 50-training-episode: mean/median 38.1/-0.6, min/max -1.7/102.3
Update 176/280, T 362496, FPS 146, 50-training-episode: mean/median 38.1/-0.7, min/max -1.7/102.2
Update 177/280, T 364544, FPS 147, 50-training-episode: mean/median 42.4/-0.5, min/max -1.7/102.2
Update 178/280, T 366592, FPS 147, 50-training-episode: mean/median 44.7/0.0, min/max -1.7/102.3
Update 179/280, T 368640, FPS 147, 50-training-episode: mean/median 51.0/55.4, min/max -1.7/102.3
Update 180/280, T 370688, FPS 147, 50-training-episode: mean/median 40.5/-0.7, min/max -1.7/102.3
Update 181/280, T 372736, FPS 147, 50-training-episode: mean/median 34.2/-0.6, min/max -1.7/102.3
Update 182/280, T 374784, FPS 147, 50-training-episode: mean/median 34.5/-0.6, min/max -1.6/102.2
Update 183/280, T 376832, FPS 147, 50-training-episode: mean/median 46.8/4.4, min/max -1.5/102.3
Update 184/280, T 378880, FPS 147, 50-training-episode: mean/median 48.8/8.8, min/max -1.6/102.3
Update 185/280, T 380928, FPS 147, 50-training-episode: mean/median 40.4/-0.1, min/max -1.6/102.2
Update 186/280, T 382976, FPS 147, 50-training-episode: mean/median 44.5/-0.5, min/max -1.7/110.7
Update 187/280, T 385024, FPS 147, 50-training-episode: mean/median 58.9/101.4, min/max -1.7/110.7
Update 188/280, T 387072, FPS 147, 50-training-episode: mean/median 38.3/-0.6, min/max -1.7/102.4
Update 189/280, T 389120, FPS 147, 50-training-episode: mean/median 36.5/-0.3, min/max -1.7/102.4
Update 190/280, T 391168, FPS 147, 50-training-episode: mean/median 38.7/0.2, min/max -1.6/102.4
Update 191/280, T 393216, FPS 147, 50-training-episode: mean/median 48.6/4.6, min/max -1.6/102.4
Update 192/280, T 395264, FPS 147, 50-training-episode: mean/median 50.9/55.1, min/max -1.5/111.5
Update 193/280, T 397312, FPS 147, 50-training-episode: mean/median 42.4/-0.6, min/max -1.8/111.5
Update 194/280, T 399360, FPS 147, 50-training-episode: mean/median 38.2/-0.4, min/max -1.8/102.2
Update 195/280, T 401408, FPS 147, 50-training-episode: mean/median 40.4/0.0, min/max -1.8/102.4
Update 196/280, T 403456, FPS 147, 50-training-episode: mean/median 38.2/-0.2, min/max -1.5/102.4
Update 197/280, T 405504, FPS 147, 50-training-episode: mean/median 38.4/-0.2, min/max -1.5/102.4
Update 198/280, T 407552, FPS 147, 50-training-episode: mean/median 44.6/0.3, min/max -1.7/102.4
Update 199/280, T 409600, FPS 147, 50-training-episode: mean/median 42.6/-0.3, min/max -1.7/102.3
Saved ./trained_models/ExptWalking20250807/plume_walk-v15_20250807_VRNN_constantx5b5noisy3x5b5_stepoobmetabolicfound_bx2.52_t57500010000_q0.40.5_dmx0.80.8_dmn0.70.4_h64_wd0.00012_n1_walking_seed23965a8.pt
Saved ./trained_models/ExptWalking20250807/plume_walk-v15_20250807_VRNN_constantx5b5noisy3x5b5_stepoobmetabolicfound_bx2.52_t57500010000_q0.40.5_dmx0.80.8_dmn0.70.4_h64_wd0.00012_n1_walking_seed23965a8.pt.best
Update 200/280, T 411648, FPS 147, 50-training-episode: mean/median 46.9/4.6, min/max -1.8/111.3
Update 201/280, T 413696, FPS 147, 50-training-episode: mean/median 56.8/101.4, min/max -1.8/111.3
Update 202/280, T 415744, FPS 147, 50-training-episode: mean/median 44.9/4.5, min/max -1.7/102.3
Update 203/280, T 417792, FPS 147, 50-training-episode: mean/median 43.4/8.6, min/max -1.7/111.0
Update 204/280, T 419840, FPS 147, 50-training-episode: mean/median 51.4/55.2, min/max -1.7/111.0
Update 205/280, T 421888, FPS 147, 50-training-episode: mean/median 54.9/101.1, min/max -1.7/102.4
Update 206/280, T 423936, FPS 147, 50-training-episode: mean/median 54.7/101.2, min/max -1.7/102.4
Update 207/280, T 425984, FPS 147, 50-training-episode: mean/median 52.9/101.2, min/max -1.7/111.8
Update 208/280, T 428032, FPS 147, 50-training-episode: mean/median 55.1/101.4, min/max -1.5/111.8
Update 209/280, T 430080, FPS 147, 50-training-episode: mean/median 48.7/4.9, min/max -1.5/111.0
Update 210/280, T 432128, FPS 147, 50-training-episode: mean/median 46.9/4.6, min/max -1.7/111.0
Update 211/280, T 434176, FPS 147, 50-training-episode: mean/median 51.0/54.9, min/max -1.7/111.3
Update 212/280, T 436224, FPS 147, 50-training-episode: mean/median 44.9/0.4, min/max -1.7/111.3
Update 213/280, T 438272, FPS 147, 50-training-episode: mean/median 38.7/-0.6, min/max -1.8/111.4
Update 214/280, T 440320, FPS 147, 50-training-episode: mean/median 42.4/-0.6, min/max -1.8/111.4
Update 215/280, T 442368, FPS 147, 50-training-episode: mean/median 38.6/-0.1, min/max -1.6/102.4
Update 216/280, T 444416, FPS 148, 50-training-episode: mean/median 46.9/4.7, min/max -1.4/102.4
Update 217/280, T 446464, FPS 148, 50-training-episode: mean/median 53.0/101.3, min/max -1.7/102.3
Update 218/280, T 448512, FPS 148, 50-training-episode: mean/median 48.4/-0.1, min/max -1.7/102.3
Update 219/280, T 450560, FPS 148, 50-training-episode: mean/median 40.8/-0.3, min/max -1.7/102.3
Update 220/280, T 452608, FPS 148, 50-training-episode: mean/median 39.2/0.3, min/max -1.7/111.7
Update 221/280, T 454656, FPS 148, 50-training-episode: mean/median 33.7/0.3, min/max -1.3/111.7
Update 222/280, T 456704, FPS 148, 50-training-episode: mean/median 41.4/4.4, min/max -1.6/111.7
Update 223/280, T 458752, FPS 148, 50-training-episode: mean/median 42.7/0.4, min/max -1.6/102.3
Update 224/280, T 460800, FPS 148, 50-training-episode: mean/median 42.7/0.2, min/max -1.6/111.5
Update 225/280, T 462848, FPS 148, 50-training-episode: mean/median 35.1/-0.3, min/max -1.6/111.5
Update 226/280, T 464896, FPS 148, 50-training-episode: mean/median 37.1/-0.4, min/max -1.7/111.4
Update 227/280, T 466944, FPS 148, 50-training-episode: mean/median 38.6/-0.4, min/max -1.7/111.4
Update 228/280, T 468992, FPS 148, 50-training-episode: mean/median 32.6/-0.7, min/max -1.6/102.4
Update 229/280, T 471040, FPS 148, 50-training-episode: mean/median 34.8/-0.7, min/max -1.8/102.4
Update 230/280, T 473088, FPS 148, 50-training-episode: mean/median 42.8/0.3, min/max -1.8/111.4
Update 231/280, T 475136, FPS 148, 50-training-episode: mean/median 48.9/4.7, min/max -1.6/111.4
Update 232/280, T 477184, FPS 148, 50-training-episode: mean/median 46.6/0.2, min/max -1.6/102.4
Update 233/280, T 479232, FPS 148, 50-training-episode: mean/median 50.7/50.8, min/max -1.6/111.4
Update 234/280, T 481280, FPS 148, 50-training-episode: mean/median 57.1/101.3, min/max -1.6/111.4
Update 235/280, T 483328, FPS 148, 50-training-episode: mean/median 44.9/4.5, min/max -1.7/102.3
Update 236/280, T 485376, FPS 148, 50-training-episode: mean/median 42.7/-0.4, min/max -1.7/102.3
Update 237/280, T 487424, FPS 148, 50-training-episode: mean/median 40.2/-0.6, min/max -1.7/102.3
Update 238/280, T 489472, FPS 148, 50-training-episode: mean/median 36.1/-0.6, min/max -1.6/102.3
Update 239/280, T 491520, FPS 148, 50-training-episode: mean/median 40.4/-0.1, min/max -1.6/102.2
Update 240/280, T 493568, FPS 148, 50-training-episode: mean/median 46.6/0.5, min/max -1.6/102.3
Update 241/280, T 495616, FPS 148, 50-training-episode: mean/median 38.1/-0.6, min/max -1.8/102.3
Update 242/280, T 497664, FPS 148, 50-training-episode: mean/median 40.2/-0.4, min/max -1.8/102.4
Update 243/280, T 499712, FPS 148, 50-training-episode: mean/median 34.5/-0.4, min/max -1.8/102.4
Update 244/280, T 501760, FPS 148, 50-training-episode: mean/median 26.8/-0.3, min/max -1.7/102.4
Update 245/280, T 503808, FPS 148, 50-training-episode: mean/median 28.4/-0.6, min/max -1.7/102.3
Update 246/280, T 505856, FPS 148, 50-training-episode: mean/median 48.8/4.5, min/max -1.7/110.8
Update 247/280, T 507904, FPS 148, 50-training-episode: mean/median 46.9/4.3, min/max -1.8/110.8
Update 248/280, T 509952, FPS 148, 50-training-episode: mean/median 46.6/4.4, min/max -1.8/102.3
Update 249/280, T 512000, FPS 148, 50-training-episode: mean/median 48.7/9.1, min/max -1.8/102.3
Update 250/280, T 514048, FPS 148, 50-training-episode: mean/median 44.6/0.3, min/max -1.8/102.2
Update 251/280, T 516096, FPS 148, 50-training-episode: mean/median 38.5/-0.6, min/max -1.6/111.3
Update 252/280, T 518144, FPS 148, 50-training-episode: mean/median 34.5/-0.6, min/max -1.7/111.3
Update 253/280, T 520192, FPS 148, 50-training-episode: mean/median 36.1/-0.6, min/max -1.7/102.3
Update 254/280, T 522240, FPS 148, 50-training-episode: mean/median 40.5/0.1, min/max -1.7/111.4
Update 255/280, T 524288, FPS 148, 50-training-episode: mean/median 26.7/-0.7, min/max -1.7/111.4
Update 256/280, T 526336, FPS 148, 50-training-episode: mean/median 22.8/-0.7, min/max -1.6/102.3
Update 257/280, T 528384, FPS 148, 50-training-episode: mean/median 30.8/-0.6, min/max -1.6/102.3
Update 258/280, T 530432, FPS 148, 50-training-episode: mean/median 30.7/-0.5, min/max -1.6/102.3
Update 259/280, T 532480, FPS 148, 50-training-episode: mean/median 40.7/-0.0, min/max -1.5/102.4
Update 260/280, T 534528, FPS 148, 50-training-episode: mean/median 46.6/0.0, min/max -1.5/102.4
Update 261/280, T 536576, FPS 148, 50-training-episode: mean/median 48.5/4.7, min/max -1.7/102.4
Update 262/280, T 538624, FPS 148, 50-training-episode: mean/median 50.8/55.3, min/max -1.7/102.4
Update 263/280, T 540672, FPS 148, 50-training-episode: mean/median 54.9/101.3, min/max -1.7/102.4
Update 264/280, T 542720, FPS 148, 50-training-episode: mean/median 58.8/101.3, min/max -1.7/102.3
Update 265/280, T 544768, FPS 148, 50-training-episode: mean/median 56.9/101.2, min/max -1.7/111.0
Update 266/280, T 546816, FPS 148, 50-training-episode: mean/median 46.8/0.5, min/max -1.6/111.0
Update 267/280, T 548864, FPS 148, 50-training-episode: mean/median 44.4/0.4, min/max -1.5/102.4
Update 268/280, T 550912, FPS 148, 50-training-episode: mean/median 50.7/55.2, min/max -1.7/102.4
Update 269/280, T 552960, FPS 148, 50-training-episode: mean/median 50.9/55.2, min/max -1.7/111.7
Update 270/280, T 555008, FPS 148, 50-training-episode: mean/median 48.8/0.4, min/max -1.7/111.7
Update 271/280, T 557056, FPS 148, 50-training-episode: mean/median 52.9/101.2, min/max -1.6/111.4
Update 272/280, T 559104, FPS 148, 50-training-episode: mean/median 53.1/101.2, min/max -1.7/111.6
Update 273/280, T 561152, FPS 148, 50-training-episode: mean/median 36.5/-0.3, min/max -1.8/111.6
Update 274/280, T 563200, FPS 148, 50-training-episode: mean/median 40.3/-0.0, min/max -1.8/102.4
Update 275/280, T 565248, FPS 148, 50-training-episode: mean/median 53.0/101.3, min/max -1.8/111.1
Update 276/280, T 567296, FPS 148, 50-training-episode: mean/median 57.3/101.4, min/max -1.7/111.1
Update 277/280, T 569344, FPS 148, 50-training-episode: mean/median 34.6/0.2, min/max -1.7/102.4
Update 278/280, T 571392, FPS 148, 50-training-episode: mean/median 25.0/-0.5, min/max -1.7/111.4
Saved ./trained_models/ExptWalking20250807/plume_walk-v15_20250807_VRNN_constantx5b5noisy3x5b5_stepoobmetabolicfound_bx2.52_t57500010000_q0.40.5_dmx0.80.8_dmn0.70.4_h64_wd0.00012_n1_walking_seed23965a8.pt
Update 279/280, T 573440, FPS 148, 50-training-episode: mean/median 22.6/-0.6, min/max -1.8/102.4
Stage: 1/2 - noisy3x5b5 b2.0 q0.5 n10000
Using Precomputed Plume...
PlumeEnvironment: {'self': <plume_env.PlumeEnvironment object at 0x30e5161c0>, 't_val_min': 10.0, 'sim_steps_max': 2200, 'reset_offset_tmax': 30, 'dataset': 'noisy3x5b5', 'move_capacity': 2.0, 'turn_capacity': 19.634954084936208, 'wind_obsx': 1.0, 'movex': 1.0, 'turnx': 1.0, 'birthx': 2.0, 'birthx_max': 1.0, 'env_dt': 0.04, 'loc_algo': 'uniform', 'qvar': 0.5, 'time_algo': 'uniform', 'angle_algo': 'uniform', 'homed_radius': 0.2, 'stray_max': 2.0, 'wind_rel': True, 'auto_movex': False, 'auto_reward': False, 'diff_max': 0.8, 'diff_min': 0.4, 'r_shaping': ['step', 'oob', 'metabolic', 'found'], 'rewardx': 1.0, 'rescale': False, 'squash_action': True, 'walking': True, 'walk_move': 0.05, 'walk_turn': 3.14159, 'radiusx': 1.0, 'diffusion_min': 1.0, 'diffusion_max': 1.0, 'action_feedback': False, 'flipping': True, 'odor_scaling': True, 'obs_noise': 0.0, 'act_noise': 0.0, 'dynamic': False, 'seed': 23965, 'verbose': 0, '__class__': <class 'plume_env.PlumeEnvironment'>}
Squashing actions to 0-1
noisy3x5b5
wind: t_val_diff 0.03999999999999915 env_dt 0.04
puffs: t_val_diff 0.03999999999999915 env_dt 0.04
Reward Shaping ['step', 'oob', 'metabolic', 'found']
Saved ./trained_models/ExptWalking20250807/plume_walk-v15_20250807_VRNN_constantx5b5noisy3x5b5_stepoobmetabolicfound_bx2.52_t57500010000_q0.40.5_dmx0.80.8_dmn0.70.4_h64_wd0.00012_n1_walking_seed23965a8.pt
Update 0/4, T 2048, FPS 107, 50-training-episode: mean/median -0.7/-1.2, min/max -1.8/9.6
Update 1/4, T 4096, FPS 100, 50-training-episode: mean/median -0.9/-1.1, min/max -1.8/9.2
Update 2/4, T 6144, FPS 97, 50-training-episode: mean/median -0.8/-1.3, min/max -1.8/9.3
Saved ./trained_models/ExptWalking20250807/plume_walk-v15_20250807_VRNN_constantx5b5noisy3x5b5_stepoobmetabolicfound_bx2.52_t57500010000_q0.40.5_dmx0.80.8_dmn0.70.4_h64_wd0.00012_n1_walking_seed23965a8.pt
Update 3/4, T 8192, FPS 97, 50-training-episode: mean/median 1.8/-1.0, min/max -1.9/101.3
Saved ./trained_models/ExptWalking20250807//plume_walk-v15_20250807_VRNN_constantx5b5noisy3x5b5_stepoobmetabolicfound_bx2.52_t57500010000_q0.40.5_dmx0.80.8_dmn0.70.4_h64_wd0.00012_n1_walking_seed23965a8.pt
Starting evaluation
Evaluating on dataset: switch15x5b5
Using Precomputed Plume...
PlumeEnvironment: {'self': <plume_env.PlumeEnvironment object at 0x30e516fd0>, 't_val_min': 10.0, 'sim_steps_max': 2200, 'reset_offset_tmax': 30, 'dataset': 'switch15x5b5', 'move_capacity': 2.0, 'turn_capacity': 19.634954084936208, 'wind_obsx': 1.0, 'movex': 1.0, 'turnx': 1.0, 'birthx': 1.0, 'birthx_max': 1.0, 'env_dt': 0.04, 'loc_algo': 'uniform', 'qvar': 0.0, 'time_algo': 'uniform', 'angle_algo': 'uniform', 'homed_radius': 0.2, 'stray_max': 2.0, 'wind_rel': True, 'auto_movex': False, 'auto_reward': False, 'diff_max': 0.8, 'diff_min': 0.4, 'r_shaping': ['step', 'oob', 'metabolic', 'found'], 'rewardx': 1.0, 'rescale': False, 'squash_action': True, 'walking': True, 'walk_move': 0.05, 'walk_turn': 3.14159, 'radiusx': 1.0, 'diffusion_min': 1.0, 'diffusion_max': 1.0, 'action_feedback': False, 'flipping': False, 'odor_scaling': True, 'obs_noise': 0.0, 'act_noise': 0.0, 'dynamic': False, 'seed': 23965, 'verbose': 0, '__class__': <class 'plume_env.PlumeEnvironment'>}
Squashing actions to 0-1
switch15x5b5
Exception: [Errno 2] No such file or directory: '/Users/aaravsinha/plume/plumedata//puff_data_switch15x5b5.pickle'
Traceback (most recent call last):
  File "/Users/aaravsinha/manyplume/oneplume/ppo/evalCli.py", line 271, in eval_loop
    env = make_vec_envs(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/a2c_ppo_acktr/envs.py", line 132, in make_vec_envs
    envs = DummyVecEnv(envs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 26, in __init__
    self.envs = [fn() for fn in env_fns]
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 26, in <listcomp>
    self.envs = [fn() for fn in env_fns]
  File "/Users/aaravsinha/manyplume/oneplume/ppo/a2c_ppo_acktr/envs.py", line 34, in _thunk
    env = plume_env.PlumeEnvironment(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 116, in __init__
    self.set_dataset(dataset)
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 206, in set_dataset
    self.data_puffs_all, self.data_wind_all = sim_analysis.load_plume(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../sim_analysis.py", line 173, in load_plume
    data_puffs = pandas.read_pickle(puff_filename)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/io/pickle.py", line 185, in read_pickle
    with get_handle(
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/io/common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/Users/aaravsinha/plume/plumedata//puff_data_switch15x5b5.pickle'
Evaluating on dataset: switch30x5b5
Using Precomputed Plume...
PlumeEnvironment: {'self': <plume_env.PlumeEnvironment object at 0x30e516e50>, 't_val_min': 10.0, 'sim_steps_max': 2200, 'reset_offset_tmax': 30, 'dataset': 'switch30x5b5', 'move_capacity': 2.0, 'turn_capacity': 19.634954084936208, 'wind_obsx': 1.0, 'movex': 1.0, 'turnx': 1.0, 'birthx': 1.0, 'birthx_max': 1.0, 'env_dt': 0.04, 'loc_algo': 'uniform', 'qvar': 0.0, 'time_algo': 'uniform', 'angle_algo': 'uniform', 'homed_radius': 0.2, 'stray_max': 2.0, 'wind_rel': True, 'auto_movex': False, 'auto_reward': False, 'diff_max': 0.8, 'diff_min': 0.4, 'r_shaping': ['step', 'oob', 'metabolic', 'found'], 'rewardx': 1.0, 'rescale': False, 'squash_action': True, 'walking': True, 'walk_move': 0.05, 'walk_turn': 3.14159, 'radiusx': 1.0, 'diffusion_min': 1.0, 'diffusion_max': 1.0, 'action_feedback': False, 'flipping': False, 'odor_scaling': True, 'obs_noise': 0.0, 'act_noise': 0.0, 'dynamic': False, 'seed': 23965, 'verbose': 0, '__class__': <class 'plume_env.PlumeEnvironment'>}
Squashing actions to 0-1
switch30x5b5
Exception: [Errno 2] No such file or directory: '/Users/aaravsinha/plume/plumedata//puff_data_switch30x5b5.pickle'
Traceback (most recent call last):
  File "/Users/aaravsinha/manyplume/oneplume/ppo/evalCli.py", line 271, in eval_loop
    env = make_vec_envs(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/a2c_ppo_acktr/envs.py", line 132, in make_vec_envs
    envs = DummyVecEnv(envs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 26, in __init__
    self.envs = [fn() for fn in env_fns]
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 26, in <listcomp>
    self.envs = [fn() for fn in env_fns]
  File "/Users/aaravsinha/manyplume/oneplume/ppo/a2c_ppo_acktr/envs.py", line 34, in _thunk
    env = plume_env.PlumeEnvironment(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 116, in __init__
    self.set_dataset(dataset)
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 206, in set_dataset
    self.data_puffs_all, self.data_wind_all = sim_analysis.load_plume(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../sim_analysis.py", line 173, in load_plume
    data_puffs = pandas.read_pickle(puff_filename)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/io/pickle.py", line 185, in read_pickle
    with get_handle(
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/io/common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/Users/aaravsinha/plume/plumedata//puff_data_switch30x5b5.pickle'
Evaluating on dataset: switch45x5b5
Using Precomputed Plume...
PlumeEnvironment: {'self': <plume_env.PlumeEnvironment object at 0x3019c54c0>, 't_val_min': 10.0, 'sim_steps_max': 2200, 'reset_offset_tmax': 30, 'dataset': 'switch45x5b5', 'move_capacity': 2.0, 'turn_capacity': 19.634954084936208, 'wind_obsx': 1.0, 'movex': 1.0, 'turnx': 1.0, 'birthx': 1.0, 'birthx_max': 1.0, 'env_dt': 0.04, 'loc_algo': 'uniform', 'qvar': 0.0, 'time_algo': 'uniform', 'angle_algo': 'uniform', 'homed_radius': 0.2, 'stray_max': 2.0, 'wind_rel': True, 'auto_movex': False, 'auto_reward': False, 'diff_max': 0.8, 'diff_min': 0.4, 'r_shaping': ['step', 'oob', 'metabolic', 'found'], 'rewardx': 1.0, 'rescale': False, 'squash_action': True, 'walking': True, 'walk_move': 0.05, 'walk_turn': 3.14159, 'radiusx': 1.0, 'diffusion_min': 1.0, 'diffusion_max': 1.0, 'action_feedback': False, 'flipping': False, 'odor_scaling': True, 'obs_noise': 0.0, 'act_noise': 0.0, 'dynamic': False, 'seed': 23965, 'verbose': 0, '__class__': <class 'plume_env.PlumeEnvironment'>}
Squashing actions to 0-1
switch45x5b5
Exception: [Errno 2] No such file or directory: '/Users/aaravsinha/plume/plumedata//puff_data_switch45x5b5.pickle'
Traceback (most recent call last):
  File "/Users/aaravsinha/manyplume/oneplume/ppo/evalCli.py", line 271, in eval_loop
    env = make_vec_envs(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/a2c_ppo_acktr/envs.py", line 132, in make_vec_envs
    envs = DummyVecEnv(envs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 26, in __init__
    self.envs = [fn() for fn in env_fns]
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 26, in <listcomp>
    self.envs = [fn() for fn in env_fns]
  File "/Users/aaravsinha/manyplume/oneplume/ppo/a2c_ppo_acktr/envs.py", line 34, in _thunk
    env = plume_env.PlumeEnvironment(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 116, in __init__
    self.set_dataset(dataset)
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 206, in set_dataset
    self.data_puffs_all, self.data_wind_all = sim_analysis.load_plume(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../sim_analysis.py", line 173, in load_plume
    data_puffs = pandas.read_pickle(puff_filename)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/io/pickle.py", line 185, in read_pickle
    with get_handle(
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/io/common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/Users/aaravsinha/plume/plumedata//puff_data_switch45x5b5.pickle'
Evaluating on dataset: constantx5b5
Using Precomputed Plume...
PlumeEnvironment: {'self': <plume_env.PlumeEnvironment object at 0x3019c5ac0>, 't_val_min': 10.0, 'sim_steps_max': 2200, 'reset_offset_tmax': 30, 'dataset': 'constantx5b5', 'move_capacity': 2.0, 'turn_capacity': 19.634954084936208, 'wind_obsx': 1.0, 'movex': 1.0, 'turnx': 1.0, 'birthx': 1.0, 'birthx_max': 1.0, 'env_dt': 0.04, 'loc_algo': 'uniform', 'qvar': 0.0, 'time_algo': 'uniform', 'angle_algo': 'uniform', 'homed_radius': 0.2, 'stray_max': 2.0, 'wind_rel': True, 'auto_movex': False, 'auto_reward': False, 'diff_max': 0.8, 'diff_min': 0.4, 'r_shaping': ['step', 'oob', 'metabolic', 'found'], 'rewardx': 1.0, 'rescale': False, 'squash_action': True, 'walking': True, 'walk_move': 0.05, 'walk_turn': 3.14159, 'radiusx': 1.0, 'diffusion_min': 1.0, 'diffusion_max': 1.0, 'action_feedback': False, 'flipping': False, 'odor_scaling': True, 'obs_noise': 0.0, 'act_noise': 0.0, 'dynamic': False, 'seed': 23965, 'verbose': 0, '__class__': <class 'plume_env.PlumeEnvironment'>}
Squashing actions to 0-1
constantx5b5
wind: t_val_diff 0.03999999999999915 env_dt 0.04
puffs: t_val_diff 0.03999999999999915 env_dt 0.04
Reward Shaping ['step', 'oob', 'metabolic', 'found']
Using fixed evaluation sequence [time, angle, loc_y]... (240 episodes) 
Exception: name 'nan' is not defined
Traceback (most recent call last):
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 231, in resolve
    return self.resolvers[key]
  File "/opt/anaconda3/envs/py39/lib/python3.9/collections/__init__.py", line 941, in __getitem__
    return self.__missing__(key)            # support subclasses that define __missing__
  File "/opt/anaconda3/envs/py39/lib/python3.9/collections/__init__.py", line 933, in __missing__
    raise KeyError(key)
KeyError: 'nan'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 242, in resolve
    return self.temps[key]
KeyError: 'nan'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/aaravsinha/manyplume/oneplume/ppo/evalCli.py", line 289, in eval_loop
    episode_logs, episode_summaries = evaluate_agent(actor_critic, env, args)
  File "/Users/aaravsinha/manyplume/oneplume/ppo/evalCli.py", line 180, in evaluate_agent
    obs = env.reset()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/a2c_ppo_acktr/envs.py", line 208, in reset
    obs = self.venv.reset()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 284, in reset
    obs = self.venv.reset()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 74, in reset
    obs = self.envs[env_idx].reset()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 449, in reset
    observation = self.sense_environment()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 270, in sense_environment
    odor_observation = sim_analysis.get_concentration_at_tidx(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../sim_analysis.py", line 263, in get_concentration_at_tidx
    d = data[data.tidx==tidx].query(q)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/frame.py", line 4828, in query
    res = self.eval(expr, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/frame.py", line 4954, in eval
    return _eval(expr, inplace=inplace, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/eval.py", line 339, in eval
    parsed_expr = Expr(expr, engine=engine, parser=parser, env=env)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 809, in __init__
    self.terms = self.parse()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 828, in parse
    return self._visitor.visit(self.expr)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 419, in visit_Module
    return self.visit(expr, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 422, in visit_Expr
    return self.visit(node.value, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 746, in visit_BoolOp
    return reduce(visitor, operands)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 740, in visitor
    rhs = self._try_visit_binop(y)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 735, in _try_visit_binop
    return self.visit(bop)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 719, in visit_Compare
    return self.visit(binop)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 535, in visit_BinOp
    op, op_class, left, right = self._maybe_transform_eq_ne(node)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 453, in _maybe_transform_eq_ne
    left = self.visit(node.left, side="left")
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 545, in visit_Name
    return self.term_type(node.id, self.env, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/ops.py", line 91, in __init__
    self._value = self._resolve_name()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/ops.py", line 115, in _resolve_name
    res = self.env.resolve(local_name, is_local=is_local)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 244, in resolve
    raise UndefinedVariableError(key, is_local) from err
pandas.errors.UndefinedVariableError: name 'nan' is not defined
Sparse/birthx: 0.8
Using Precomputed Plume...
PlumeEnvironment: {'self': <plume_env.PlumeEnvironment object at 0x30e5164c0>, 't_val_min': 10.0, 'sim_steps_max': 2200, 'reset_offset_tmax': 30, 'dataset': 'constantx5b5', 'move_capacity': 2.0, 'turn_capacity': 19.634954084936208, 'wind_obsx': 1.0, 'movex': 1, 'turnx': 1.0, 'birthx': 1.0, 'birthx_max': 0.8, 'env_dt': 0.04, 'loc_algo': 'quantile', 'qvar': 0.0, 'time_algo': 'uniform', 'angle_algo': 'uniform', 'homed_radius': 0.2, 'stray_max': 2.0, 'wind_rel': True, 'auto_movex': False, 'auto_reward': False, 'diff_max': 0.8, 'diff_min': 0.4, 'r_shaping': ['step', 'oob', 'metabolic', 'found'], 'rewardx': 1.0, 'rescale': False, 'squash_action': True, 'walking': True, 'walk_move': 0.05, 'walk_turn': 3.14159, 'radiusx': 1.0, 'diffusion_min': 1.0, 'diffusion_max': 1.0, 'action_feedback': False, 'flipping': False, 'odor_scaling': True, 'obs_noise': 0.0, 'act_noise': 0.0, 'dynamic': False, 'seed': 23965, 'verbose': 0, '__class__': <class 'plume_env.PlumeEnvironment'>}
Squashing actions to 0-1
constantx5b5
Sparsifying puffs to 0.8x
wind: t_val_diff 0.03999999999999915 env_dt 0.04
puffs: t_val_diff 0.03999999999999915 env_dt 0.04
Reward Shaping ['step', 'oob', 'metabolic', 'found']
Using fixed evaluation sequence [time, angle, loc_y]... (240 episodes) 
Exception: name 'nan' is not defined
Traceback (most recent call last):
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 231, in resolve
    return self.resolvers[key]
  File "/opt/anaconda3/envs/py39/lib/python3.9/collections/__init__.py", line 941, in __getitem__
    return self.__missing__(key)            # support subclasses that define __missing__
  File "/opt/anaconda3/envs/py39/lib/python3.9/collections/__init__.py", line 933, in __missing__
    raise KeyError(key)
KeyError: 'nan'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 242, in resolve
    return self.temps[key]
KeyError: 'nan'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/aaravsinha/manyplume/oneplume/ppo/evalCli.py", line 363, in eval_loop
    episode_logs, episode_summaries = evaluate_agent(actor_critic, env, args)
  File "/Users/aaravsinha/manyplume/oneplume/ppo/evalCli.py", line 180, in evaluate_agent
    obs = env.reset()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/a2c_ppo_acktr/envs.py", line 208, in reset
    obs = self.venv.reset()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 284, in reset
    obs = self.venv.reset()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 74, in reset
    obs = self.envs[env_idx].reset()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 449, in reset
    observation = self.sense_environment()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 270, in sense_environment
    odor_observation = sim_analysis.get_concentration_at_tidx(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../sim_analysis.py", line 263, in get_concentration_at_tidx
    d = data[data.tidx==tidx].query(q)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/frame.py", line 4828, in query
    res = self.eval(expr, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/frame.py", line 4954, in eval
    return _eval(expr, inplace=inplace, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/eval.py", line 339, in eval
    parsed_expr = Expr(expr, engine=engine, parser=parser, env=env)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 809, in __init__
    self.terms = self.parse()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 828, in parse
    return self._visitor.visit(self.expr)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 419, in visit_Module
    return self.visit(expr, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 422, in visit_Expr
    return self.visit(node.value, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 746, in visit_BoolOp
    return reduce(visitor, operands)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 740, in visitor
    rhs = self._try_visit_binop(y)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 735, in _try_visit_binop
    return self.visit(bop)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 719, in visit_Compare
    return self.visit(binop)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 535, in visit_BinOp
    op, op_class, left, right = self._maybe_transform_eq_ne(node)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 453, in _maybe_transform_eq_ne
    left = self.visit(node.left, side="left")
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 545, in visit_Name
    return self.term_type(node.id, self.env, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/ops.py", line 91, in __init__
    self._value = self._resolve_name()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/ops.py", line 115, in _resolve_name
    res = self.env.resolve(local_name, is_local=is_local)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 244, in resolve
    raise UndefinedVariableError(key, is_local) from err
pandas.errors.UndefinedVariableError: name 'nan' is not defined
Sparse/birthx: 0.6
Using Precomputed Plume...
PlumeEnvironment: {'self': <plume_env.PlumeEnvironment object at 0x17040e0d0>, 't_val_min': 10.0, 'sim_steps_max': 2200, 'reset_offset_tmax': 30, 'dataset': 'constantx5b5', 'move_capacity': 2.0, 'turn_capacity': 19.634954084936208, 'wind_obsx': 1.0, 'movex': 1, 'turnx': 1.0, 'birthx': 1.0, 'birthx_max': 0.6, 'env_dt': 0.04, 'loc_algo': 'quantile', 'qvar': 0.0, 'time_algo': 'uniform', 'angle_algo': 'uniform', 'homed_radius': 0.2, 'stray_max': 2.0, 'wind_rel': True, 'auto_movex': False, 'auto_reward': False, 'diff_max': 0.8, 'diff_min': 0.4, 'r_shaping': ['step', 'oob', 'metabolic', 'found'], 'rewardx': 1.0, 'rescale': False, 'squash_action': True, 'walking': True, 'walk_move': 0.05, 'walk_turn': 3.14159, 'radiusx': 1.0, 'diffusion_min': 1.0, 'diffusion_max': 1.0, 'action_feedback': False, 'flipping': False, 'odor_scaling': True, 'obs_noise': 0.0, 'act_noise': 0.0, 'dynamic': False, 'seed': 23965, 'verbose': 0, '__class__': <class 'plume_env.PlumeEnvironment'>}
Squashing actions to 0-1
constantx5b5
Sparsifying puffs to 0.6x
wind: t_val_diff 0.03999999999999915 env_dt 0.04
puffs: t_val_diff 0.03999999999999915 env_dt 0.04
Reward Shaping ['step', 'oob', 'metabolic', 'found']
Using fixed evaluation sequence [time, angle, loc_y]... (240 episodes) 
Exception: name 'nan' is not defined
Traceback (most recent call last):
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 231, in resolve
    return self.resolvers[key]
  File "/opt/anaconda3/envs/py39/lib/python3.9/collections/__init__.py", line 941, in __getitem__
    return self.__missing__(key)            # support subclasses that define __missing__
  File "/opt/anaconda3/envs/py39/lib/python3.9/collections/__init__.py", line 933, in __missing__
    raise KeyError(key)
KeyError: 'nan'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 242, in resolve
    return self.temps[key]
KeyError: 'nan'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/aaravsinha/manyplume/oneplume/ppo/evalCli.py", line 363, in eval_loop
    episode_logs, episode_summaries = evaluate_agent(actor_critic, env, args)
  File "/Users/aaravsinha/manyplume/oneplume/ppo/evalCli.py", line 180, in evaluate_agent
    obs = env.reset()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/a2c_ppo_acktr/envs.py", line 208, in reset
    obs = self.venv.reset()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 284, in reset
    obs = self.venv.reset()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 74, in reset
    obs = self.envs[env_idx].reset()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 449, in reset
    observation = self.sense_environment()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 270, in sense_environment
    odor_observation = sim_analysis.get_concentration_at_tidx(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../sim_analysis.py", line 263, in get_concentration_at_tidx
    d = data[data.tidx==tidx].query(q)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/frame.py", line 4828, in query
    res = self.eval(expr, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/frame.py", line 4954, in eval
    return _eval(expr, inplace=inplace, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/eval.py", line 339, in eval
    parsed_expr = Expr(expr, engine=engine, parser=parser, env=env)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 809, in __init__
    self.terms = self.parse()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 828, in parse
    return self._visitor.visit(self.expr)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 419, in visit_Module
    return self.visit(expr, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 422, in visit_Expr
    return self.visit(node.value, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 746, in visit_BoolOp
    return reduce(visitor, operands)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 740, in visitor
    rhs = self._try_visit_binop(y)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 735, in _try_visit_binop
    return self.visit(bop)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 719, in visit_Compare
    return self.visit(binop)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 535, in visit_BinOp
    op, op_class, left, right = self._maybe_transform_eq_ne(node)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 453, in _maybe_transform_eq_ne
    left = self.visit(node.left, side="left")
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 545, in visit_Name
    return self.term_type(node.id, self.env, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/ops.py", line 91, in __init__
    self._value = self._resolve_name()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/ops.py", line 115, in _resolve_name
    res = self.env.resolve(local_name, is_local=is_local)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 244, in resolve
    raise UndefinedVariableError(key, is_local) from err
pandas.errors.UndefinedVariableError: name 'nan' is not defined
Sparse/birthx: 0.4
Using Precomputed Plume...
PlumeEnvironment: {'self': <plume_env.PlumeEnvironment object at 0x3019c54c0>, 't_val_min': 10.0, 'sim_steps_max': 2200, 'reset_offset_tmax': 30, 'dataset': 'constantx5b5', 'move_capacity': 2.0, 'turn_capacity': 19.634954084936208, 'wind_obsx': 1.0, 'movex': 1, 'turnx': 1.0, 'birthx': 1.0, 'birthx_max': 0.4, 'env_dt': 0.04, 'loc_algo': 'quantile', 'qvar': 0.0, 'time_algo': 'uniform', 'angle_algo': 'uniform', 'homed_radius': 0.2, 'stray_max': 2.0, 'wind_rel': True, 'auto_movex': False, 'auto_reward': False, 'diff_max': 0.8, 'diff_min': 0.4, 'r_shaping': ['step', 'oob', 'metabolic', 'found'], 'rewardx': 1.0, 'rescale': False, 'squash_action': True, 'walking': True, 'walk_move': 0.05, 'walk_turn': 3.14159, 'radiusx': 1.0, 'diffusion_min': 1.0, 'diffusion_max': 1.0, 'action_feedback': False, 'flipping': False, 'odor_scaling': True, 'obs_noise': 0.0, 'act_noise': 0.0, 'dynamic': False, 'seed': 23965, 'verbose': 0, '__class__': <class 'plume_env.PlumeEnvironment'>}
Squashing actions to 0-1
constantx5b5
Sparsifying puffs to 0.4x
wind: t_val_diff 0.03999999999999915 env_dt 0.04
puffs: t_val_diff 0.03999999999999915 env_dt 0.04
Reward Shaping ['step', 'oob', 'metabolic', 'found']
Using fixed evaluation sequence [time, angle, loc_y]... (240 episodes) 
Exception: name 'nan' is not defined
Traceback (most recent call last):
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 231, in resolve
    return self.resolvers[key]
  File "/opt/anaconda3/envs/py39/lib/python3.9/collections/__init__.py", line 941, in __getitem__
    return self.__missing__(key)            # support subclasses that define __missing__
  File "/opt/anaconda3/envs/py39/lib/python3.9/collections/__init__.py", line 933, in __missing__
    raise KeyError(key)
KeyError: 'nan'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 242, in resolve
    return self.temps[key]
KeyError: 'nan'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/aaravsinha/manyplume/oneplume/ppo/evalCli.py", line 363, in eval_loop
    episode_logs, episode_summaries = evaluate_agent(actor_critic, env, args)
  File "/Users/aaravsinha/manyplume/oneplume/ppo/evalCli.py", line 180, in evaluate_agent
    obs = env.reset()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/a2c_ppo_acktr/envs.py", line 208, in reset
    obs = self.venv.reset()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 284, in reset
    obs = self.venv.reset()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 74, in reset
    obs = self.envs[env_idx].reset()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 449, in reset
    observation = self.sense_environment()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 270, in sense_environment
    odor_observation = sim_analysis.get_concentration_at_tidx(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../sim_analysis.py", line 263, in get_concentration_at_tidx
    d = data[data.tidx==tidx].query(q)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/frame.py", line 4828, in query
    res = self.eval(expr, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/frame.py", line 4954, in eval
    return _eval(expr, inplace=inplace, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/eval.py", line 339, in eval
    parsed_expr = Expr(expr, engine=engine, parser=parser, env=env)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 809, in __init__
    self.terms = self.parse()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 828, in parse
    return self._visitor.visit(self.expr)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 419, in visit_Module
    return self.visit(expr, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 422, in visit_Expr
    return self.visit(node.value, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 746, in visit_BoolOp
    return reduce(visitor, operands)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 740, in visitor
    rhs = self._try_visit_binop(y)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 735, in _try_visit_binop
    return self.visit(bop)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 719, in visit_Compare
    return self.visit(binop)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 535, in visit_BinOp
    op, op_class, left, right = self._maybe_transform_eq_ne(node)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 453, in _maybe_transform_eq_ne
    left = self.visit(node.left, side="left")
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 545, in visit_Name
    return self.term_type(node.id, self.env, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/ops.py", line 91, in __init__
    self._value = self._resolve_name()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/ops.py", line 115, in _resolve_name
    res = self.env.resolve(local_name, is_local=is_local)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 244, in resolve
    raise UndefinedVariableError(key, is_local) from err
pandas.errors.UndefinedVariableError: name 'nan' is not defined
Sparse/birthx: 0.2
Using Precomputed Plume...
PlumeEnvironment: {'self': <plume_env.PlumeEnvironment object at 0x30e516fd0>, 't_val_min': 10.0, 'sim_steps_max': 2200, 'reset_offset_tmax': 30, 'dataset': 'constantx5b5', 'move_capacity': 2.0, 'turn_capacity': 19.634954084936208, 'wind_obsx': 1.0, 'movex': 1, 'turnx': 1.0, 'birthx': 1.0, 'birthx_max': 0.2, 'env_dt': 0.04, 'loc_algo': 'quantile', 'qvar': 0.0, 'time_algo': 'uniform', 'angle_algo': 'uniform', 'homed_radius': 0.2, 'stray_max': 2.0, 'wind_rel': True, 'auto_movex': False, 'auto_reward': False, 'diff_max': 0.8, 'diff_min': 0.4, 'r_shaping': ['step', 'oob', 'metabolic', 'found'], 'rewardx': 1.0, 'rescale': False, 'squash_action': True, 'walking': True, 'walk_move': 0.05, 'walk_turn': 3.14159, 'radiusx': 1.0, 'diffusion_min': 1.0, 'diffusion_max': 1.0, 'action_feedback': False, 'flipping': False, 'odor_scaling': True, 'obs_noise': 0.0, 'act_noise': 0.0, 'dynamic': False, 'seed': 23965, 'verbose': 0, '__class__': <class 'plume_env.PlumeEnvironment'>}
Squashing actions to 0-1
constantx5b5
Sparsifying puffs to 0.2x
wind: t_val_diff 0.03999999999999915 env_dt 0.04
puffs: t_val_diff 0.03999999999999915 env_dt 0.04
Reward Shaping ['step', 'oob', 'metabolic', 'found']
Using fixed evaluation sequence [time, angle, loc_y]... (240 episodes) 
Exception: name 'nan' is not defined
Traceback (most recent call last):
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 231, in resolve
    return self.resolvers[key]
  File "/opt/anaconda3/envs/py39/lib/python3.9/collections/__init__.py", line 941, in __getitem__
    return self.__missing__(key)            # support subclasses that define __missing__
  File "/opt/anaconda3/envs/py39/lib/python3.9/collections/__init__.py", line 933, in __missing__
    raise KeyError(key)
KeyError: 'nan'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 242, in resolve
    return self.temps[key]
KeyError: 'nan'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/aaravsinha/manyplume/oneplume/ppo/evalCli.py", line 363, in eval_loop
    episode_logs, episode_summaries = evaluate_agent(actor_critic, env, args)
  File "/Users/aaravsinha/manyplume/oneplume/ppo/evalCli.py", line 180, in evaluate_agent
    obs = env.reset()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/a2c_ppo_acktr/envs.py", line 208, in reset
    obs = self.venv.reset()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 284, in reset
    obs = self.venv.reset()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 74, in reset
    obs = self.envs[env_idx].reset()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 449, in reset
    observation = self.sense_environment()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 270, in sense_environment
    odor_observation = sim_analysis.get_concentration_at_tidx(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../sim_analysis.py", line 263, in get_concentration_at_tidx
    d = data[data.tidx==tidx].query(q)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/frame.py", line 4828, in query
    res = self.eval(expr, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/frame.py", line 4954, in eval
    return _eval(expr, inplace=inplace, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/eval.py", line 339, in eval
    parsed_expr = Expr(expr, engine=engine, parser=parser, env=env)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 809, in __init__
    self.terms = self.parse()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 828, in parse
    return self._visitor.visit(self.expr)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 419, in visit_Module
    return self.visit(expr, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 422, in visit_Expr
    return self.visit(node.value, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 746, in visit_BoolOp
    return reduce(visitor, operands)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 740, in visitor
    rhs = self._try_visit_binop(y)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 735, in _try_visit_binop
    return self.visit(bop)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 719, in visit_Compare
    return self.visit(binop)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 535, in visit_BinOp
    op, op_class, left, right = self._maybe_transform_eq_ne(node)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 453, in _maybe_transform_eq_ne
    left = self.visit(node.left, side="left")
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 545, in visit_Name
    return self.term_type(node.id, self.env, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/ops.py", line 91, in __init__
    self._value = self._resolve_name()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/ops.py", line 115, in _resolve_name
    res = self.env.resolve(local_name, is_local=is_local)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 244, in resolve
    raise UndefinedVariableError(key, is_local) from err
pandas.errors.UndefinedVariableError: name 'nan' is not defined
Evaluating on dataset: noisy3x5b5
Using Precomputed Plume...
PlumeEnvironment: {'self': <plume_env.PlumeEnvironment object at 0x17cb3d9a0>, 't_val_min': 10.0, 'sim_steps_max': 2200, 'reset_offset_tmax': 30, 'dataset': 'noisy3x5b5', 'move_capacity': 2.0, 'turn_capacity': 19.634954084936208, 'wind_obsx': 1.0, 'movex': 1, 'turnx': 1.0, 'birthx': 1.0, 'birthx_max': 0.2, 'env_dt': 0.04, 'loc_algo': 'quantile', 'qvar': 0.0, 'time_algo': 'uniform', 'angle_algo': 'uniform', 'homed_radius': 0.2, 'stray_max': 2.0, 'wind_rel': True, 'auto_movex': False, 'auto_reward': False, 'diff_max': 0.8, 'diff_min': 0.4, 'r_shaping': ['step', 'oob', 'metabolic', 'found'], 'rewardx': 1.0, 'rescale': False, 'squash_action': True, 'walking': True, 'walk_move': 0.05, 'walk_turn': 3.14159, 'radiusx': 1.0, 'diffusion_min': 1.0, 'diffusion_max': 1.0, 'action_feedback': False, 'flipping': False, 'odor_scaling': True, 'obs_noise': 0.0, 'act_noise': 0.0, 'dynamic': False, 'seed': 23965, 'verbose': 0, '__class__': <class 'plume_env.PlumeEnvironment'>}
Squashing actions to 0-1
noisy3x5b5
Sparsifying puffs to 0.2x
wind: t_val_diff 0.03999999999999915 env_dt 0.04
puffs: t_val_diff 0.03999999999999915 env_dt 0.04
Reward Shaping ['step', 'oob', 'metabolic', 'found']
Using fixed evaluation sequence [time, angle, loc_y]... (240 episodes) 
Exception: name 'nan' is not defined
Traceback (most recent call last):
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 231, in resolve
    return self.resolvers[key]
  File "/opt/anaconda3/envs/py39/lib/python3.9/collections/__init__.py", line 941, in __getitem__
    return self.__missing__(key)            # support subclasses that define __missing__
  File "/opt/anaconda3/envs/py39/lib/python3.9/collections/__init__.py", line 933, in __missing__
    raise KeyError(key)
KeyError: 'nan'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 242, in resolve
    return self.temps[key]
KeyError: 'nan'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/aaravsinha/manyplume/oneplume/ppo/evalCli.py", line 289, in eval_loop
    episode_logs, episode_summaries = evaluate_agent(actor_critic, env, args)
  File "/Users/aaravsinha/manyplume/oneplume/ppo/evalCli.py", line 180, in evaluate_agent
    obs = env.reset()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/a2c_ppo_acktr/envs.py", line 208, in reset
    obs = self.venv.reset()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/vec_normalize.py", line 284, in reset
    obs = self.venv.reset()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 74, in reset
    obs = self.envs[env_idx].reset()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 449, in reset
    observation = self.sense_environment()
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 270, in sense_environment
    odor_observation = sim_analysis.get_concentration_at_tidx(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../sim_analysis.py", line 263, in get_concentration_at_tidx
    d = data[data.tidx==tidx].query(q)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/frame.py", line 4828, in query
    res = self.eval(expr, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/frame.py", line 4954, in eval
    return _eval(expr, inplace=inplace, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/eval.py", line 339, in eval
    parsed_expr = Expr(expr, engine=engine, parser=parser, env=env)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 809, in __init__
    self.terms = self.parse()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 828, in parse
    return self._visitor.visit(self.expr)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 419, in visit_Module
    return self.visit(expr, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 422, in visit_Expr
    return self.visit(node.value, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 746, in visit_BoolOp
    return reduce(visitor, operands)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 740, in visitor
    rhs = self._try_visit_binop(y)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 735, in _try_visit_binop
    return self.visit(bop)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 719, in visit_Compare
    return self.visit(binop)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 535, in visit_BinOp
    op, op_class, left, right = self._maybe_transform_eq_ne(node)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 453, in _maybe_transform_eq_ne
    left = self.visit(node.left, side="left")
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 413, in visit
    return visitor(node, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/expr.py", line 545, in visit_Name
    return self.term_type(node.id, self.env, **kwargs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/ops.py", line 91, in __init__
    self._value = self._resolve_name()
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/ops.py", line 115, in _resolve_name
    res = self.env.resolve(local_name, is_local=is_local)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/core/computation/scope.py", line 244, in resolve
    raise UndefinedVariableError(key, is_local) from err
pandas.errors.UndefinedVariableError: name 'nan' is not defined
Evaluating on dataset: noisy6x5b5
Using Precomputed Plume...
PlumeEnvironment: {'self': <plume_env.PlumeEnvironment object at 0x3019c5760>, 't_val_min': 10.0, 'sim_steps_max': 2200, 'reset_offset_tmax': 30, 'dataset': 'noisy6x5b5', 'move_capacity': 2.0, 'turn_capacity': 19.634954084936208, 'wind_obsx': 1.0, 'movex': 1, 'turnx': 1.0, 'birthx': 1.0, 'birthx_max': 0.2, 'env_dt': 0.04, 'loc_algo': 'quantile', 'qvar': 0.0, 'time_algo': 'uniform', 'angle_algo': 'uniform', 'homed_radius': 0.2, 'stray_max': 2.0, 'wind_rel': True, 'auto_movex': False, 'auto_reward': False, 'diff_max': 0.8, 'diff_min': 0.4, 'r_shaping': ['step', 'oob', 'metabolic', 'found'], 'rewardx': 1.0, 'rescale': False, 'squash_action': True, 'walking': True, 'walk_move': 0.05, 'walk_turn': 3.14159, 'radiusx': 1.0, 'diffusion_min': 1.0, 'diffusion_max': 1.0, 'action_feedback': False, 'flipping': False, 'odor_scaling': True, 'obs_noise': 0.0, 'act_noise': 0.0, 'dynamic': False, 'seed': 23965, 'verbose': 0, '__class__': <class 'plume_env.PlumeEnvironment'>}
Squashing actions to 0-1
noisy6x5b5
Exception: [Errno 2] No such file or directory: '/Users/aaravsinha/plume/plumedata//puff_data_noisy6x5b5.pickle'
Traceback (most recent call last):
  File "/Users/aaravsinha/manyplume/oneplume/ppo/evalCli.py", line 271, in eval_loop
    env = make_vec_envs(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/a2c_ppo_acktr/envs.py", line 132, in make_vec_envs
    envs = DummyVecEnv(envs)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 26, in __init__
    self.envs = [fn() for fn in env_fns]
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 26, in <listcomp>
    self.envs = [fn() for fn in env_fns]
  File "/Users/aaravsinha/manyplume/oneplume/ppo/a2c_ppo_acktr/envs.py", line 34, in _thunk
    env = plume_env.PlumeEnvironment(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 116, in __init__
    self.set_dataset(dataset)
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../plume_env.py", line 206, in set_dataset
    self.data_puffs_all, self.data_wind_all = sim_analysis.load_plume(
  File "/Users/aaravsinha/manyplume/oneplume/ppo/../sim_analysis.py", line 173, in load_plume
    data_puffs = pandas.read_pickle(puff_filename)
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/io/pickle.py", line 185, in read_pickle
    with get_handle(
  File "/opt/anaconda3/envs/py39/lib/python3.9/site-packages/pandas/io/common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
FileNotFoundError: [Errno 2] No such file or directory: '/Users/aaravsinha/plume/plumedata//puff_data_noisy6x5b5.pickle'
